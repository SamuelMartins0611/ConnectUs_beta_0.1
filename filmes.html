<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ConnectUs ‚Äî Cinema</title>
<style>
  :root{
    --bg:#000; --fg:#fff; --card:#141414; --muted:#9b9b9b; --accent:#4aa3ff; --btn:#333;
  }
  body{ margin:0; font-family:Arial, sans-serif; background:var(--bg); color:var(--fg); transition:background .25s,color .25s; }
  .temaClaro{ --bg:#f5f5f5; --fg:#111; --card:#fff; --muted:#555; --btn:#ddd; }
  header{ padding:16px; text-align:center; background:#111; border-bottom:2px solid #333; position:sticky; top:0; z-index:50;}
  header h1{ margin:0; font-size:20px; }
  .wrap{ max-width:1200px; margin:18px auto; padding:12px; }
  .controls-row{ display:flex; flex-direction:column; gap:18px;  align-items:center;  width: 300px ; margin: 0 auto;}
  .left-controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  #resultsInfo{width: 300px; text-align: center;}
  .search-box{ display:flex; gap:8px; align-items:center; justify-content:center ; width: 300px;}
  .search-box input[type="search"]{ padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.08); background:transparent; color:var(--fg); width:320px; }
  .icon-btn{ background:var(--btn); color:var(--fg); border:none; padding:10px; border-radius:10px; cursor:pointer; font-size:16px; }
  .filters{ margin-top:14px; display:grid; grid-template-columns: repeat(auto-fit,minmax(160px,1fr)); gap:12px; align-items:start; }
  .filter-card{ background:var(--card); padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,.03); font-size:14px; }
  .filter-card label{ display:block; margin-bottom:6px; font-weight:600; }
  .filter-card select, .filter-card input[type="text"]{ width:100%; padding:8px 10px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,.06); color:var(--fg); }
  .filter-actions{ margin-top:12px; display:flex; gap:8px; }
  .btn-primary{ background:var(--accent); color:#fff; border:none; padding:10px 12px; border-radius:10px; cursor:pointer; }
  .btn-secondary{ background:transparent; border:1px solid rgba(255,255,255,.08); color:var(--fg); padding:10px 12px; border-radius:10px; cursor:pointer; }
  .grid{ margin-top:18px; display:grid; gap:16px; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); }
  .card{ background:var(--card); border-radius:12px; padding:10px; display:flex; flex-direction:column; gap:8px; border:1px solid rgba(255,255,255,.03); cursor:pointer; }
  .poster{ width:100%; height:300px; background-size:cover; background-position:center; border-radius:8px; }
  .meta{ display:flex; justify-content:space-between; align-items:center; gap:8px; }
  .title{ font-size:16px; margin:0; }
  .tags{ color:var(--muted); font-size:13px; margin:0; }
  .card .actions{ margin-top:auto; display:flex; gap:8px; }
  .small{ font-size:13px; color:var(--muted); }
  #escutando{ display:none; margin-top:10px; color:#0f0; font-weight:700; text-align:center; }
  #searchInput{ display:flex; border-radius:10px; padding: 10px ; border-style: none;}
  
  /* Modal details */
  #modalDetails{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.75); z-index:2000; padding:20px; overflow:auto; }
  #modalInner{ max-width:900px; margin:40px auto; background:var(--card); padding:18px; border-radius:12px; border:1px solid rgba(255,255,255,.04); color:var(--fg); }
  .row{ display:flex; gap:14px; flex-wrap:wrap; }
  .col{ flex:1; min-width:220px; }
  .badge{ display:inline-block; padding:6px 8px; border-radius:8px; background:rgba(255,255,255,.04); font-size:13px; margin-right:6px; }
  /* perfil button */
  .profile-box{ position:fixed; right:12px; top:12px; z-index:1200; }
  .profile-btn{ background:var(--btn); border:none; padding:10px 12px; border-radius:10px; cursor:pointer; color:var(--fg); }
  /* responsive */
 
 /* --- Checkboxes bonitos (estilo ConnectUs moderno) --- */

.custom-check {
  display: flex;
  align-items: center;
  justify-items: center;
  text-align: center;
  gap: 10px;
  padding: 8px 10px;
  background: rgba(255,255,255,0.06);
  border-radius: 12px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: 0.25s;
  font-size: 14px;
}

.custom-check:hover {
  background: rgba(255,255,255,0.12);
}

/* escondemos o checkbox original */
.custom-check input {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}

.checkmark {
  width: 20px;
  height: 20px;
  border-radius: 6px;
  background: rgba(255,255,255,0.12);
  border: 2px solid rgba(255,255,255,0.2);
  display: flex;
  justify-content: center;
  align-items: center;
  transition: 0.25s;
}

/* quando marcado */
.custom-check input:checked + .checkmark {
  background: var(--accent);
  border-color: var(--accent);
}

.checkmark::after {
  content: "‚úî";
  color: white;
  font-size: 14px;
  opacity: 0;
  transition: 0.25s;
}

/* show checkmark */
.custom-check input:checked + .checkmark::after {
  opacity: 1;
}

/* --- Dropdown de Acessibilidade (Cinema) --- */

#acessDropdown {
  position: fixed;
  left: 10px;
  top: 10px;
  z-index: 1500;
  background: var(--card);
  color: var(--fg);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 8px;
  padding: 6px 8px;
  width: 3%;
  font-size: 14px;
  cursor: pointer;
  outline: none;
  transition: 0.2s;
}

/* Apar√™ncia do select */
#acessDropdown select {
  background: transparent;
  color: var(--fg);
  border: none;
  font-size: 15px;
  padding: 4px;
  cursor: pointer;
  width: 100%;
}

/* Ao abrir */
#acessDropdown select:focus {
  outline: none;
  border: none;
}

/* Op√ß√µes internas */
#acessDropdown option {
  background: var(--card);
  color: var(--fg);
  padding: 6px;
}
@media (max-width:720px){
    .search-box input[type="search"]{
        width:160px;
    }
    header h1{ 
      display: flex;
       flex-direction: column;
         font-size:18px; 
      }
    .poster{
        height:220px;
    }
    #acessDropdown {
      width: 12%;
      };
    #acessDropdown select{
      width: 10%;
    }
  }
</style>
</head>
<body>

<header>
  <h1 onmouseover="safeRead('Cinema ‚Äî Explorar filmes')">ConnectUs ‚Äî Cinema</h1>
</header>
    <div id="acessDropdown">
  <select id="menuAcessibilidade" onchange="executarOpcao(this.value)">
        <option value="">‚öô</option>
        <option value="zoomIn">Aumentar Zoom</option>
        <option value="zoomOut">Diminuir Zoom</option>
        <option value="modoCalmo">Modo Calmo</option>
        <option value="pauseAudio">Pausar Leitura</option>
        <option value="resumeAudio">Retomar Leitura</option>
        <option value="toggleTheme">Tema Claro/Escuro</option>
        <option value="desativarVoz">Desativar Voz</option>
        <option value="ativarVoz">Ativar Voz</option>
        <option value="voltarHome">üè† In√≠cio</option>
  </select>
</div>

<!-- profile quick -->
<div class="profile-box" aria-hidden="false">
  <button class="profile-btn" onclick="abrirPerfilModal()" title="Meu perfil">üë§ Perfil</button>
</div>

<main class="wrap" id="main">
  <div class="controls-row">
    <div class="left-controls">
      <div class="search-box" role="search" aria-label="Busca de filmes">
        <input id="searchInput" placeholder="Pesquisar t√≠tulo, ator, diretor..." aria-label="Pesquisar" />
        <button class="icon-btn" id="btnSearch" onclick="applyFilters()" title="Pesquisar">üîé</button>
        <button class="icon-btn" id="btnMic" title="Pesquisar por voz" onclick="startVoiceSearch()">üéôÔ∏è</button>
      </div>
      <div class="small" id="resultsInfo" aria-live="polite">Mostrando todos os filmes</div>
    </div>

    <div>
      <button class="btn-primary" onclick="resetFilters()">Limpar filtros</button>
      <button class="btn-secondary" onclick="scrollToGrid()">Ir para lista</button>
    </div>
  </div>

  <!-- filters -->
  <div class="filters" role="region" aria-label="Filtros de busca">
    <div class="filter-card">
      <label for="genre">G√™nero</label>
      <select id="genre" aria-label="Filtrar por g√™nero">
        <option value="">Todos</option>
        <option>a√ß√£o</option><option>aventura</option><option>com√©dia</option><option>drama</option>
        <option>romance</option><option>terror</option><option>suspense</option><option>fic√ß√£o cient√≠fica</option>
        <option>fantasia</option><option>anima√ß√£o</option><option>document√°rio</option><option>nacional</option>
      </select>
    </div>

    <div class="filter-card">
      <label for="year">Ano </label>
      <select id="year" aria-label="Filtrar por ano">
        <option value="">Qualquer</option>
        <option value="2023">2023‚Äì2025</option>
        <option value="2018">2018‚Äì2022</option>
        <option value="2010">2010‚Äì2017</option>
        <option value="2000">2000‚Äì2009</option>
        <option value="1990">1990‚Äì1999</option>
        <option value="1980">antes de 1990</option>
      </select>
    </div>

    <div class="filter-card">
      <label for="duration">Dura√ß√£o</label>
      <select id="duration" aria-label="Filtrar por dura√ß√£o">
        <option value="">Qualquer</option>
        <option value="short">Curta (0‚Äì40)</option>
        <option value="medium">M√©dia (40‚Äì90)</option>
        <option value="long">Longa (90‚Äì150)</option>
        <option value="epic">√âpico (150+)</option>
      </select>
    </div>


    <div class="filter-card">
      <label for="country">Origem</label>
      <select id="country" aria-label="Filtrar por pa√≠s">
        <option value="">Qualquer</option>
        <option>Brasil</option><option>EUA</option><option>Europa</option><option>√Åsia</option><option>Coreia</option>
      </select>
    </div>

    <div class="filter-card">
      <label for="age">Classifica√ß√£o</label>
      <select id="age" aria-label="Filtrar por classifica√ß√£o">
        <option value="">Qualquer</option>
        <option value="L">Livre</option><option value="10">+10</option><option value="12">+12</option><option value="14">+14</option>
        <option value="16">+16</option><option value="18">+18</option>
      </select>
    </div>

    <div class="filter-card">
      <label for="sort">Ordenar por</label>
      <select id="sort" aria-label="Ordenar resultados">
        <option value="popular">Mais populares</option>
        <option value="rating">Melhor avaliados</option>
        <option value="new">Lan√ßamentos</option>
        <option value="duration">Dura√ß√£o</option>
      </select>
    </div>

      <div class="filter-card">
        <label>Acessibilidade</label>

        <label class="custom-check">
          <input type="checkbox" id="ad">
          <span class="checkmark"></span>
          ‚ôø Audiodescri√ß√£o
        </label>

        <label class="custom-check">
          <input type="checkbox" id="cc">
          <span class="checkmark"></span>
          üí¨ Legendas (CC)
        </label>

        <label class="custom-check">
          <input type="checkbox" id="libras">
          <span class="checkmark"></span>
          ü§ü Libras
        </label>

        <label class="custom-check">
          <input type="checkbox" id="highContrast">
          <span class="checkmark"></span>
          üé® Contraste aprimorado
        </label>
      </div>

  </div>

  <div id="escutando" role="status" aria-live="polite">üéß Ouvindo voc√™‚Ä¶</div>

  <!-- results -->
  <section id="resultsGrid" class="grid" aria-label="Resultados de filmes"></section>

  <div style="margin-top:18px; text-align:center;">
    <small class="small">Exemplo de cat√°logo com capas (placeholder usado a partir do arquivo enviado).</small>
  </div>
</main>

<!-- modal details -->
<div id="modalDetails" aria-hidden="true">
  <div id="modalInner" role="dialog">

    <button class="icon-btn" onclick="closeModal()" style="float:right">‚úñ</button>

    <div class="row">
      <div class="col" id="modalPoster"></div>

      <div class="col">
        <h2 id="modalTitle">T√≠tulo</h2>
        <p id="modalTags" class="small"></p>
        <p id="modalDesc"></p>

        <div style="margin-top:12px;">
          <span class="badge" id="modalDuration"></span>
          <span class="badge" id="modalYear"></span>
          <span class="badge" id="modalAge"></span>
        </div>

        <!-- AQUI entram os novos blocos -->
        <div id="modalAcess" style="margin-top:14px;"></div>

        <div id="modalAssistir" style="margin-top:14px;"></div>

        <div style="margin-top:14px;">
          <strong>Dire√ß√£o:</strong> <span id="modalDiretor"></span><br>
          <strong>Elenco:</strong> <span id="modalElenco"></span>
        </div>

        <!-- Bot√µes originais -->
        <div style="margin-top:14px;">
          <button class="btn-primary" onclick="playDemo()">‚ñ∂ Assistir (exemplo)</button>
          <button class="btn-secondary" onclick="speakDetails()">üîä Ouvir detalhes</button>
        </div>

      </div>
    </div>
  </div>
</div>


<!-- perfil modal (simples) -->
<div id="perfilModal" style="display:none; position:fixed; right:12px; top:60px; z-index:1500; background:var(--card); padding:12px; border-radius:8px; border:1px solid rgba(255,255,255,.04);">
  <div style="font-weight:700">Seu Perfil</div>
  <div class="small" id="miniNome">Nome: ‚Äî</div>
  <div class="small" id="miniInter">Interesse: ‚Äî</div>
  <div style="margin-top:8px;">
    <button class="btn-secondary" onclick="closePerfilModal()">Fechar</button>
    <button class="btn-primary" onclick="editarPerfil()">Editar</button>
  </div>
</div>

<!-- VLibras -->
<div vw class="enabled" style="z-index:1300">
  <div vw-access-button class="active"></div>
  <div vw-plugin-wrapper><div class="vw-plugin-top-wrapper"></div></div>
</div>
<script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
<script> new window.VLibras && new window.VLibras.Widget('https://vlibras.gov.br/app'); </script>

<script>
/* ---------- Sample dataset (t√≠tulos reais) ----------
   Usamos o arquivo enviado (local path) para poster de exemplo.
   Substitua poster pelo caminho real de cada imagem se quiser.
*/
const POSTER_PLACEHOLDER = '/mnt/data/fa144841-e950-433c-880c-321b334cc53d.png';

const films = [
  {
  id: 1,
  title: 'Vingadores: Ultimato',
  genre: 'a√ß√£o',
  year: 2019,
  duration: 181,
  country: 'EUA',
  age: '14',
  rating: 8.4,

  desc: 'Super-her√≥is unem for√ßas para reverter o estalo.',
  poster: "img/utlimato.jpg",

  // -------- NOVO --------
  diretor: "Anthony Russo, Joe Russo",
  elenco: [
    "Robert Downey Jr.",
    "Chris Evans",
    "Scarlett Johansson",
    "Chris Hemsworth"
  ],

  acessibilidade: {
    ad: true,
    cc: true,
    libras: false
  },

  assistir: [
    { nome: "Disney+", url: "https://www.disneyplus.com" }
  ],

  trailer: "https://www.youtube.com/watch?v=TcMBFSGVi1c"
},
  { id:2, title:'O Poderoso Chef√£o', genre:'drama', year:1972, duration:175, country:'EUA', age:'16', rating:9.2, ad:false, cc:true, libras:false, desc:'Fam√≠lia mafiosa e poder.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_bestv2/oJagOzBu9Rdd9BrciseCm3U3MCU.jpg"},
  { id:3, title:'Parasita', genre:'suspense', year:2019, duration:132, country:'Coreia', age:'16', rating:8.6, ad:false, cc:true, libras:false, desc:'Cr√≠tica social e tens√£o crescente.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_bestv2/igw938inb6Fy0YVcwIyxQ7Lu5FO.jpg"},
  { id:4, title:'Cidade de Deus', genre:'drama', year:2002, duration:130, country:'Brasil', age:'16', rating:8.6, ad:false, cc:true, libras:false, desc:'Hist√≥ria da favela e ascens√£o do crime.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_face/gfnXixcGC060QcG6JPxN6AMdVsq.jpg"},
  { id:5, title:'Toy Story', genre:'anima√ß√£o', year:1995, duration:81, country:'EUA', age:'L', rating:8.3, ad:false, cc:true, libras:false, desc:'Brinquedos que ganham vida.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_face/6AafgfifXkFS4g2xGJZIwsPQK6P.jpg"},
  { id:6, title:'Coringa', genre:'drama', year:2019, duration:122, country:'EUA', age:'18', rating:8.4, ad:false, cc:false, libras:false, desc:'Origem do vil√£o e cr√≠tica √† sociedade.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_face/xLxgVxFWvb9hhUyCDDXxRPPnFck.jpg"},
  { id:7, title:'Intoc√°veis', genre:'com√©dia', year:2011, duration:112, country:'Europa', age:'14', rating:8.5, ad:true, cc:true, libras:false, desc:'Amizade entre homem rico e cuidador.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_face/sHcqCSjDAdQI5g0SFJOZGmLGr9Z.jpg"},
  { id:8, title:'1917', genre:'guerra', year:2019, duration:119, country:'Europa', age:'16', rating:8.3, ad:false, cc:true, libras:false, desc:'Miss√£o em tempo real durante a guerra.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_face/m6VVgmwNdOWvLo8nlheLPQU5wr7.jpg"},
  { id:9, title:'A Origem', genre:'fic√ß√£o cient√≠fica', year:2010, duration:148, country:'EUA', age:'14', rating:8.8, ad:false, cc:true, libras:false, desc:'Sonhos dentro de sonhos.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_face/9e3Dz7aCANy5aRUQF745IlNloJ1.jpg"},
  { id:10, title:'Bacurau', genre:'drama', year:2019, duration:131, country:'Brasil', age:'16', rating:7.6, ad:false, cc:true, libras:false, desc:'Vila no sert√£o reage a amea√ßas externas.' , poster:"https://media.themoviedb.org/t/p/w300_and_h450_face/qvmLAVqNB5TbGUa9QqQvXiFC4UR.jpg"}
];

/* ---------- Utilities ---------- */
function speak(text, opts={}) {
  try { window.speechSynthesis.cancel(); } catch(e){}
  const u = new SpeechSynthesisUtterance(text);
  u.lang = opts.lang || 'pt-BR';
  if (opts.rate) u.rate = opts.rate;
  if (opts.onend) u.onend = opts.onend;
  try { speechSynthesis.speak(u); } catch(e){}
}

function safeRead(text){
  if (!text) return;
  speak(text);
}

/* ---------- Render grid ---------- */
function renderGrid(list){
  const grid = document.getElementById('resultsGrid');
  grid.innerHTML = '';
  if (!list.length) {
    document.getElementById('resultsInfo').innerText = 'Nenhum resultado.';
    return;
  }
  document.getElementById('resultsInfo').innerText = `Mostrando ${list.length} resultado(s)`;
  list.forEach(f=>{
    const el = document.createElement('article');
    el.className = 'card';
    el.setAttribute('tabindex','0');
    el.setAttribute('role','button');
    el.setAttribute('data-id', f.id);
    el.innerHTML = `
      <div class="poster" style="background-image:url('${f.poster}')"></div>
      <div>
        <h3 class="title">${f.title}</h3>
        <p class="tags">${f.genre} ‚Ä¢ ${f.duration} min ‚Ä¢ ${f.year}</p>
        <p class="small">${f.country} ‚Ä¢ Class.: ${f.age} ‚Ä¢ Avalia√ß√£o: ${f.rating}</p>
      </div>
      <div class="actions">
        <button class="btn-primary" onclick="abrirDetalhes(event,${f.id})">Assistir</button>
        <button class="btn-secondary" onclick="abrirDetalhes(event,${f.id})">Detalhes</button>
      </div>
    `;
    // hover/focus read
    el.addEventListener('mouseover', ()=> safeRead(f.title + ', ' + f.genre));
    el.addEventListener('focus', ()=> safeRead(f.title + ', ' + f.genre));
    grid.appendChild(el);
  });
}

/* ---------- Filtering logic ---------- */
function applyFilters(){
  const q = document.getElementById('searchInput').value.trim().toLowerCase();
  const genre = document.getElementById('genre').value.toLowerCase();
  const yearSel = document.getElementById('year').value;
  const duration = document.getElementById('duration').value;
  const ad = document.getElementById('ad').checked;
  const cc = document.getElementById('cc').checked;
  const libras = document.getElementById('libras').checked;
  const country = document.getElementById('country').value.toLowerCase();
  const age = document.getElementById('age').value;

  let out = films.filter(f=>{
    // search by title, desc
    if (q) {
      const inText = (f.title + ' ' + f.desc + ' ' + f.country).toLowerCase();
      if (!inText.includes(q)) return false;
    }
    if (genre && f.genre.toLowerCase() !== genre) return false;
    if (country && f.country.toLowerCase() !== country) return false;
    if (age && f.age !== age) return false;

    if (yearSel) {
      if (yearSel === '2023' && f.year < 2023) return false;
      if (yearSel === '2018' && (f.year < 2018 || f.year > 2022)) return false;
      if (yearSel === '2010' && (f.year < 2010 || f.year > 2017)) return false;
      if (yearSel === '2000' && (f.year < 2000 || f.year > 2009)) return false;
      if (yearSel === '1990' && (f.year < 1990 || f.year > 1999)) return false;
      if (yearSel === '1980' && f.year >= 1990) return false;
    }

    if (duration) {
      if (duration === 'short' && f.duration > 40) return false;
      if (duration === 'medium' && (f.duration < 40 || f.duration > 90)) return false;
      if (duration === 'long' && (f.duration < 90 || f.duration > 150)) return false;
      if (duration === 'epic' && f.duration < 150) return false;
    }

    if (ad && !f.ad) return false;
    if (cc && !f.cc) return false;
    if (libras && !f.libras) return false;

    return true;
  });

  // sort
  const sort = document.getElementById('sort').value;
  if (sort === 'rating') out.sort((a,b)=> b.rating - a.rating);
  if (sort === 'new') out.sort((a,b)=> b.year - a.year);
  if (sort === 'duration') out.sort((a,b)=> b.duration - a.duration);
  // default popular: rating * some factor
  if (sort === 'popular') out.sort((a,b)=> (b.rating) - (a.rating));

  renderGrid(out);
}

/* ---------- Reset filters ---------- */
function resetFilters(){
  document.getElementById('searchInput').value = '';
  document.getElementById('genre').value = '';
  document.getElementById('year').value = '';
  document.getElementById('duration').value = '';
  document.getElementById('ad').checked = false;
  document.getElementById('cc').checked = false;
  document.getElementById('libras').checked = false;
  document.getElementById('country').value = '';
  document.getElementById('age').value = '';
  document.getElementById('sort').value = 'popular';
  applyFilters();
}

/* ---------- Modal / details ---------- */
function abrirDetalhes(e, id) {
  if (e && e.stopPropagation) e.stopPropagation();

  const f = films.find(x => x.id === id);
  if (!f) return;

  // Dados principais
  document.getElementById('modalPoster').style.backgroundImage = `url('${f.poster}')`;
  document.getElementById('modalTitle').innerText = f.title;
  document.getElementById('modalTags').innerText = `${f.genre} ‚Ä¢ ${f.country}`;
  document.getElementById('modalDesc').innerText = f.desc;
  document.getElementById('modalDuration').innerText = f.duration + ' min';
  document.getElementById('modalYear').innerText = f.year;
  document.getElementById('modalAge').innerText = 'Class.: ' + f.age;

  /* ---------------------------------------
     NOVOS CAMPOS (Diretor, Elenco, Acessibilidade, Onde Assistir, Trailer)
     --------------------------------------- */

  // Acessibilidade
  const a = f.acessibilidade || {};
  document.getElementById("modalAcess").innerHTML = `
    <strong>Acessibilidade:</strong><br>
    ${a.ad ? "‚ôø Audiodescri√ß√£o<br>" : ""}
    ${a.cc ? "üí¨ Legendas (CC)<br>" : ""}
    ${a.libras ? "ü§ü Libras<br>" : ""}
  `;

  // Onde assistir
  document.getElementById("modalAssistir").innerHTML =
    `<strong>Onde Assistir:</strong><br>` +
    (f.assistir || []).map(a =>
      `<a class="stream-btn" href="${a.url}" target="_blank">‚ñ∂ ${a.nome}</a><br>`
    ).join("");

  // Diretor
  document.getElementById("modalDiretor").innerText = f.diretor || "‚Äî";

  // Elenco
  document.getElementById("modalElenco").innerText =
    f.elenco ? f.elenco.join(", ") : "‚Äî";

  // Trailer
  window.trailerAtual = f.trailer || null;

  // Mostrar modal
  document.getElementById('modalDetails').style.display = 'block';
  document.getElementById('modalDetails').setAttribute('aria-hidden', 'false');

  // TTS ORIGINAL MANTIDO
  speak('Abrindo detalhes de ' + f.title);
}

/* ouvir detalhes via TTS */
function speakDetails(){
  const title = document.getElementById('modalTitle').innerText;
  const desc = document.getElementById('modalDesc').innerText;
  speak(title + '. ' + desc);
}

/* ---------- Voice search ---------- */
let recognizer = null;
let recogActive = false;

function startVoiceSearch(){
  const SpeechRec = window.SpeechRecognition || window.webkitSpeechRecognition || null;
  if (!SpeechRec) { speak('Seu navegador n√£o suporta reconhecimento de voz.'); return; }
  if (recogActive) return;
  try { recognizer = new SpeechRec(); } catch(e){ recognizer = null; }
  if (!recognizer) { speak('N√£o foi poss√≠vel iniciar microfone.'); return; }

  recognizer.lang = 'pt-BR';
  recognizer.interimResults = false;
  recognizer.maxAlternatives = 1;
  recogActive = true;
  document.getElementById('escutando').style.display = 'block';
  speak('Diga o que deseja buscar. Exemplo: filmes de com√©dia ou Vingadores.', { onend: ()=> {
      try { recognizer.start(); } catch(e){ console.warn(e); }
  }});

  let heard = false;
  recognizer.onresult = function(evt){
    heard = true;
    const t = (evt.results && evt.results[0] && evt.results[0][0].transcript) ? evt.results[0][0].transcript.toLowerCase() : '';
    document.getElementById('escutando').style.display = 'none';
    recogActive = false;
    document.getElementById('searchInput').value = t;
    // if contains some keywords, map to filters
    if (t.includes('com√©dia') || t.includes('comedia')) document.getElementById('genre').value = 'com√©dia';
    if (t.includes('terror')) document.getElementById('genre').value = 'terror';
    if (t.includes('drama')) document.getElementById('genre').value = 'drama';
    if (t.includes('brasileiro') || t.includes('brasil')) document.getElementById('country').value = 'Brasil';
    if (t.match(/\b\d{4}\b/)) {
      const y = t.match(/\b\d{4}\b/)[0];
      document.getElementById('year').value = y >= 2023 ? '2023' : (y>=2018? '2018' : (y>=2010? '2010' : (y>=2000? '2000': '1990')));
    }
    applyFilters();
    speak('Resultados atualizados para: ' + t);
  };

  recognizer.onerror = function(err){
    recogActive = false;
    document.getElementById('escutando').style.display = 'none';
    speak('N√£o entendi. Tente novamente usando o bot√£o ou digite.');
  };

  recognizer.onend = function(){
    recogActive = false;
    document.getElementById('escutando').style.display = 'none';
    if (!heard) speak('N√£o foi detectada fala. Tente novamente.');
  };

  // safety stop
  setTimeout(()=> { try{ if (recogActive && recognizer) recognizer.stop(); }catch(e){} }, 9000);
}

/* ---------- Profile integration (localStorage) ---------- */
function loadProfileIntoUI(){
  const p = JSON.parse(localStorage.getItem('perfilConnectUs') || '{}');
  if (p && Object.keys(p).length) {
    // quick mini profile
    document.getElementById('miniNome').innerText = 'Nome: ' + (p.nome || '‚Äî');
    document.getElementById('miniInter').innerText = 'Interesse: ' + (p.interesse || '‚Äî');
    // optionally apply recommendation filter automatically
    if (p.interesse) {
      // set genre if interest matches known genres
      const interest = (p.interesse || '').toLowerCase();
      const known = ['a√ß√£o','aventura','com√©dia','drama','romance','terror','suspense','anima√ß√£o','document√°rio','fic√ß√£o cient√≠fica','ficcao cient√≠fica','ficcao'];
      const found = known.find(k => interest.includes(k));
      if (found) {
        document.getElementById('genre').value = found;
      }
    }
  }
}

/* open profile modal */
function abrirPerfilModal(){
  loadProfileIntoUI();
  const el = document.getElementById('perfilModal');
  el.style.display = 'block';
}

/* close perfil */
function closePerfilModal(){ document.getElementById('perfilModal').style.display='none'; }
function editarPerfil(){ speak('Abrindo tela de edi√ß√£o.'); setTimeout(()=> window.location.href='configuracao.html',500); }

/* ---------- Helpers ---------- */
function scrollToGrid(){ document.getElementById('resultsGrid').scrollIntoView({behavior:'smooth'}); }

/* inicializa√ß√£o */
document.addEventListener('DOMContentLoaded', ()=>{
  renderGrid(films);
  loadProfileIntoUI();
  // apply filters when user types enter
  document.getElementById('searchInput').addEventListener('keydown', (e)=>{ if (e.key === 'Enter') applyFilters(); });
});

function closeModal() {
  document.getElementById('modalDetails').style.display = 'none';
  document.getElementById('modalDetails').setAttribute('aria-hidden', 'true');
  
  // cancelar fala se estiver ativa
  try { speechSynthesis.cancel(); } catch(e){}
}

//dropdown config dele 
function executarOpcao(v) {
    if (!v) return;

    const map = {
        zoomIn,
        zoomOut,
        modoCalmo,
        pauseAudio,
        resumeAudio,
        toggleTheme,
        desativarVoz,
        ativarVoz,
        voltarHome
    };

    if (map[v]) map[v]();
      document.getElementById('menuAcessibilidade').value = '';
}

/* Fun√ß√µes do menu */
function zoomIn(){
    document.body.style.zoom = (parseFloat(document.body.style.zoom) || 1) + 0.1;
}

function zoomOut(){
    document.body.style.zoom = (parseFloat(document.body.style.zoom) || 1) - 0.1;
}

function modoCalmo(){
    speak("Modo calmo ativado");
    document.body.style.filter = "blur(1px) brightness(0.9)";
}

function pauseAudio(){
    window.speechSynthesis.cancel();
}

function resumeAudio(){
    speak("Retomando leitura");
}

function toggleTheme(){
    document.body.classList.toggle("temaClaro");
}


function voltarHome(){
    window.location.href = "menuConteudos.html";
}


/* --- Controle global de voz (corrige o desativar/ativar) --- */

// flag global (padr√£o ligado)
window.vozAtiva = (typeof window.vozAtiva !== 'undefined') ? window.vozAtiva : true;

/* substitua a sua fun√ß√£o speak pelo bloco abaixo (verifica vozAtiva) */
function speak(text, opts = {}) {
  // n√£o falar se a voz estiver desativada
  if (!window.vozAtiva) return;
  try { window.speechSynthesis.cancel(); } catch(e){}
  const u = new SpeechSynthesisUtterance(text);
  u.lang = opts.lang || 'pt-BR';
  if (opts.rate) u.rate = opts.rate;
  if (opts.onend) u.onend = opts.onend;
  try { speechSynthesis.speak(u); } catch(e){}
}

/* safeRead j√° chama speak, mas garante que s√≥ tenta se voz ativa */
function safeRead(text){
  if (!text) return;
  if (!window.vozAtiva) return;
  speak(text);
}

/* fun√ß√µes para ativar / desativar a fala ‚Äî use essas nas op√ß√µes do dropdown */
function desativarVoz(){
  // cancela fala ativa e desliga
  try { window.speechSynthesis.cancel(); } catch(e){}
  window.vozAtiva = false;
  // feedback visual/sonoro (apenas visual, pois voz est√° off)
  console.log('Voz desativada');
}

function ativarVoz(){
  window.vozAtiva = true;
  // d√° um pequeno feedback por voz
  speak('Voz reativada.');
  console.log('Voz ativada');
}

</script>

</body>
</html>
